import socket
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
result = sock.connect_ex(('192.200.11.9', 1521))
print('Connection Result  >> ' , result)
#  msg = sock.recv(1024)

# message to send (CONNECT_DATA=(COMMAND=version))

send_msg= bytearray ([
0x00, 0x5a, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 
0x01, 0x36, 0x01, 0x2c, 0x00, 0x00, 0x08, 0x00, 
0x7f, 0xff, 0x7f, 0x08, 0x00, 0x00, 0x00, 0x01, 
0x00, 0x20, 0x00, 0x3a, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x34, 0xe6, 0x00, 0x00, 
0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x28, 0x43, 0x4f, 0x4e, 0x4e, 0x45, 
0x43, 0x54, 0x5f, 0x44, 0x41, 0x54, 0x41, 0x3d, 
0x28, 0x43, 0x4f, 0x4d, 0x4d, 0x41, 0x4e, 0x44, 
0x3d, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6f, 0x6e, 
0x29, 0x29 ])

sock.send(send_msg)
msg = sock.recv(2048)
ascii_message=msg.decode('ascii')
vssnum_loc=ascii_message.find('VSNNUM=')
version_number=hex(int(ascii_message[vssnum_loc+7:vssnum_loc+7+9]))
sock.close()
print('Listener version : ' ,
       str(int(version_number[2:3],16))+'.'+
       str(int(version_number[3:4],16))+'.'+
       str(int(version_number[4:6],16))+'.'+
       str(int(version_number[6:7],16))+'.'+
       str(int(version_number[7:9],16))
      )
 
 
